{% extends 'base.html' %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<div class="dashboard-title">ðŸ“Š Dashboard de Auditoria</div>

<form method="get" class="row g-3 mb-4">
    <div class="col-auto">
        <label for="mes" class="form-label">Filtrar por mÃªs:</label>
        <input type="month" name="mes" id="mes" class="form-control" value="{{ mes }}">
    </div>
    <div class="col-auto mt-auto">
        <button type="submit" class="btn btn-primary">Filtrar</button>
    </div>
</form>

<div class="row text-white mb-4">
    <div class="col-md-3"><div class="card bg-primary"><div class="card-body"><h5>Total Apresentado</h5><p class="fs-5">R$ {{ "%.2f"|format(total_apresentado) }}</p></div></div></div>
    <div class="col-md-3"><div class="card bg-danger"><div class="card-body"><h5>Glosa MÃ©dico</h5><p class="fs-5">R$ {{ "%.2f"|format(total_glosa_medico) }}</p></div></div></div>
    <div class="col-md-3"><div class="card bg-warning text-dark"><div class="card-body"><h5>Glosa Enfermagem</h5><p class="fs-5">R$ {{ "%.2f"|format(total_glosa_enfermagem) }}</p></div></div></div>
    <div class="col-md-3"><div class="card bg-success"><div class="card-body"><h5>Total Liberado</h5><p class="fs-5">R$ {{ "%.2f"|format(total_liberado) }}</p></div></div></div>
</div>

<div class="mb-5"><canvas id="graficoTotais"></canvas></div>

<script>
    const ctx = document.getElementById('graficoTotais').getContext('2d');
    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: ['Apresentado', 'Glosa MÃ©dico', 'Glosa Enfermagem', 'Liberado'],
            datasets: [{
                label: 'Valores (R$)',
                data: [
                    {{ total_apresentado or 0 }},
                    {{ total_glosa_medico or 0 }},
                    {{ total_glosa_enfermagem or 0 }},
                    {{ total_liberado or 0 }}
                ],
                backgroundColor: ['#0d6efd', '#dc3545', '#ffc107', '#198754']
            }]
        },
        options: {
            responsive: true,
            scales: {
                y: { beginAtZero: true }
            }
        }
    });
</script>
{% endblock %}
